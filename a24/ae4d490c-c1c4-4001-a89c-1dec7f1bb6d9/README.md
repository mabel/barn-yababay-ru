## Конструкторы и построители как эффективное средство создания и изменения объектов Microsoft Access

В отличие от многих других систем управления базами данных (СУБД), в которых таблицы, запросы и отчеты формируются и модифицируются посредством языков семейства SQL (Structured Query Language), Access предоставляет для создания таких объектов мощные визуальные средства - конструкторы и построители (визарды).

Конструкторы  позволяют с помощью удобных элементов управления редактировать свойства таблиц, запросов, форм и отчетов.

Визарды предназначены для быстрого создания типовых объектов. При этом внешний вид настраивается автоматически в соответствии с выбранной визуальной темой. Объекты, созданные с помощью визардов, можно затем дополнительно редактировать в конструкторах.

Следует отметить, что создание и изменение таблиц и запросов в Access можно производить и традиционным способом - с помощью инструкций SQL.

## Создание таблиц в базе данных

Щелкнув на ленте главного меню по инструменту "Конструктор таблиц", вызовем соответствующий инструмент. Он сам представляет собой таблицу с тремя колонками: название поля (колонки создаваемой таблицы), тип хранящихся в нем данных  (числовой, текстовый, финансовый, дата/время и т.п.), описание (необязательное). В нижней части  имеются дополнительные вкладки, с помощью которых можно управлять свойствами полей и их внешним представлением: делать поля ключевыми, не допускающими пустых значений, содержащими только уникальные значения, позволяющими выбирать значения из списков и т.п.

Если база данных предназначена для описания относительно несложных объектов, то можно обойтись единственной таблицей, например, для ведения списка сотрудников кафедры вуза.

![Создание и правка таблицы в конструкторе](https://a24.biz/assets/files/handbook/images/7d/50/7d501455b748a954c4b1d48e72108d00)

Если информация детальна и разнообразна, как, например, в кадровом учете предприятия, то помимо основной таблицы (ее можно назвать, например, "Общие сведения") могут понадобиться вспомогательные справочники, такие как "Виды образования", "Формы обучения",   "Национальности", "Степени родства". Справочники используются для описания зависимостей вида "один к одному" и помогают при заполнении полей таблицы корректно вводить данные. Например, сотруднику может быть присуща в каждый момент времени только одна национальность, и ее выбирают из заранее подготовленного списка.

Для отслеживания динамики отдельных характеристик, например, семейного положения или продвижения по службе, можно предусмотреть дополнительные таблицы.   Например, в базе данных "Сотрудники" можно создать таблицы "Семейное положение", "Должности". Эти характеристики могут меняться со временем и полезно знать о предыдущих состояниях.

Кроме того, в отдельные таблицы целесообразно заносить сведения, имеющие отношение к основной таблице как "один к многим": у сотрудника одновременно может быть несколько контактов, несколько документов, удостоверяющих личность и т.п.

Некоторые поля в таблицах следует пометить как ключевые. В качестве ключа можно выбрать некую уникальную числовую характеристику (например, табельный номер ), однако лучшей практикой является генерация для каждой строки уникального порядкового номера. Это происходит автоматически, если присвоить ключевому полю тип "Счетчик". Вспомогательные таблицы следует связывать с основной с помощью ключевых полей. Например, в таблице "Семейное положение" можно создать поле "Идентификатор сотрудника", связанное с соответствующим полем таблицы "Основные данные". Это гарантирует отсутствие строк, указывающих на сотрудников, еще не добавленных или уже удаленных из основной таблицы.

Совокупность всех таблиц и их взаимных связей в базе данных называется схемой данных. В Access есть инструмент для ее просмотра. Рядом со связями таблиц указывается их тип: "один к одному", "один ко многим", многие к многим.

![Схема данных базы "Сотрудники"](https://a24.biz/assets/files/handbook/images/fd/f9/fdf91340b02e857d080075d6a1e5b7ac)


## Формирование запросов в Access

Иногда полезно бывает просмотреть не всю таблицу, а только те ее строки, которые соответствуют определенным критериям. Например, чтобы увидеть записи о сотрудниках предпенсионного возраста нужно выбрать тех, чей возраст превысил 50 лет. При этом сведения о возрасте нет необходимости записывать в базу данных, поскольку этот параметр меняется со временем. Возраст можно вычислять динамически как разницу между текущей датой и датой рождения.

Для решения названных задач (выборки из таблиц, формирование динамических полей) предназначены запросы. Их можно создавать в трех режимах:

1. на языке SQL;
1. с помощью конструктора;
1. с помощью визарда.

Последние два способа являются предпочтительными, так как не требуют от пользователей специальных знаний и позволяют создавать запросы с помощью интуитивно понятных инструментов.

![Запрос, формируемый на основе таблицы "Сотрудники"](https://a24.biz/assets/files/handbook/images/38/bd/38bdd95664cc3c337b463e43e255b469)

В запросе может быть задействовано более одной таблицы, что позволяет заменить безликие числовые идентификаторы реальными данными, например (в режиме SQL):

[Пример]
```
SELECT "Фамилия", "Имя", "Подразделение", "Должность", "Дата начала работы", "Дата окончатия работы" 
FROM "Сотрудники" INNER JOIN "Перемещения по службе" 
ON "Табельный номер" = "Идентификатор сотрудника" ORDER BY "Дата начала работы";

```
[/Пример]

В данном примере поля "Фамилия" и "Имя" берутся из таблицы "Общие данные", а остальные - из "Перемещения по службе". Оптимально вынести сведения о должностях и подразделениях в отдельные справочники и задействовать не 2, а 4 таблицы.

## Формы и отчеты в Access

Запросы, наряду с таблицами, являются источниками данных для форм и отчетов.

Формы служат для эффективного заполнения  и изменения содержимого таблиц и содержат такие удобные элементы интерфейса, как разворачивающиеся списки, календари и т.п. Кроме того, к одной форме можно подключить несколько таблиц: основную и зависимые от нее вспомогательные, чтобы можно было, например, быстро посмотреть изменения в семейном положении сотрудника или продвижении его по службе.

![Форма к таблице "Основные сведения" с подключенными в нижней части вспомогательными таблицами.](https://a24.biz/assets/files/handbook/images/b1/10/b1109491cb1b20f6941f6e21b5b2ae08)


Отчеты, как и формы, строятся на основе таблиц и запросов как источников данных, но содержат не элементы управления, а поля, оформленные оптимальным для печати  (вывода на бумагу) образом.

Как формы, так и отчеты целесообразно создавать с помощью визардов, а затем дорабатывать в конструкторах.